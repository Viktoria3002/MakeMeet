# Исправление ошибки миграций

## Проблема
Ошибка: `SQLite3::SQLException: index index_posts_on_author_id already exists`

Эта ошибка возникает потому, что Rails 8.0 автоматически создает индексы для внешних ключей, но в миграциях также были добавлены явные индексы, что приводит к конфликту.

## Решение

### 1. Удалены конфликтующие миграции
Удалены следующие файлы миграций:
- `db/migrate/20241220000001_create_users.rb`
- `db/migrate/20241220000002_create_posts.rb`
- `db/migrate/20241220000003_create_comments.rb`
- `db/migrate/20241220000004_create_likes.rb`
- `db/migrate/20241220000005_create_sprints.rb`
- `db/migrate/20241220000006_create_sprint_participants.rb`

### 2. Создана единая миграция
Создан новый файл `db/migrate/20241220000007_create_all_tables.rb`, который:
- Создает все таблицы в правильном порядке
- Добавляет только необходимые индексы
- Избегает конфликтов с автоматическими индексами Rails

### 3. Обновлена схема
Обновлен файл `db/schema.rb` с версией 20241220000007

## Как применить исправления

### Вариант 1: Сброс базы данных (рекомендуется)
```bash
# Удалить существующую базу данных
rm storage/development.sqlite3

# Выполнить миграции заново
rails db:migrate

# Заполнить тестовыми данными
rails db:seed
```

### Вариант 2: Откат и повторное выполнение
```bash
# Откатить все миграции
rails db:rollback STEP=10

# Выполнить новую миграцию
rails db:migrate

# Заполнить тестовыми данными
rails db:seed
```

### Вариант 3: Использование скрипта сброса
```bash
# Запустить скрипт сброса базы данных
ruby reset_database.rb
```

## Структура новой миграции

Новая миграция `20241220000007_create_all_tables.rb` создает:

1. **users** - пользователи
2. **posts** - посты
3. **comments** - комментарии
4. **likes** - лайки
5. **sprints** - спринты
6. **sprint_participants** - участники спринтов

Все таблицы создаются с правильными индексами и внешними ключами без конфликтов.

## Проверка

После применения исправлений можно проверить:
```ruby
# В Rails console
User.count
Post.count
Comment.count
Like.count
Sprint.count
SprintParticipant.count
```

Все модели должны работать корректно без ошибок.
